{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "user-menu-clerk",
  "type": "registry:component",
  "title": "User Menu (Clerk)",
  "author": "@mrzachnugent",
  "description": "A popover menu presenting options and actions for the current user with Clerk integration.",
  "dependencies": [
    "@clerk/clerk-expo"
  ],
  "registryDependencies": [
    "https://reactnativereusables.com/r/new-york/avatar.json",
    "https://reactnativereusables.com/r/new-york/button.json",
    "https://reactnativereusables.com/r/new-york/icon.json",
    "https://reactnativereusables.com/r/new-york/popover.json",
    "https://reactnativereusables.com/r/new-york/text.json"
  ],
  "files": [
    {
      "path": "./node_modules/@rnr/registry/src/blocks/clerk/user-menu.tsx",
      "content": "import { Avatar, AvatarFallback, AvatarImage } from '@/registry/new-york/components/ui/avatar';\nimport { Button } from '@/registry/new-york/components/ui/button';\nimport { Icon } from '@/registry/new-york/components/ui/icon';\nimport { Popover, PopoverContent, PopoverTrigger } from '@/registry/new-york/components/ui/popover';\nimport { Text } from '@/registry/new-york/components/ui/text';\nimport { useAuth, useUser } from '@clerk/clerk-expo';\nimport type { TriggerRef } from '@rn-primitives/popover';\nimport { LogOutIcon, PlusIcon, SettingsIcon } from 'lucide-react-native';\nimport * as React from 'react';\nimport { View } from 'react-native';\n\nexport function UserMenu() {\n  const { user } = useUser();\n  const { signOut } = useAuth();\n  const popoverTriggerRef = React.useRef<TriggerRef>(null);\n\n  async function onSignOut() {\n    popoverTriggerRef.current?.close();\n    await signOut();\n    // TODO: If your app does not use `Stack.Protected`, navigate to your sign-in screen\n  }\n\n  return (\n    <Popover>\n      <PopoverTrigger asChild ref={popoverTriggerRef}>\n        <Button variant=\"ghost\" size=\"icon\" className=\"size-8 rounded-full\">\n          <UserAvatar />\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent align=\"end\" side=\"bottom\" className=\"w-80 p-0\">\n        <View className=\"border-border gap-3 border-b p-3\">\n          <View className=\"flex-row items-center gap-3\">\n            <UserAvatar className=\"size-10\" />\n            <View className=\"flex-1\">\n              <Text className=\"font-medium leading-5\">\n                {user?.fullName || user?.emailAddresses[0]?.emailAddress}\n              </Text>\n              {user?.fullName?.length ? (\n                <Text className=\"text-muted-foreground text-sm font-normal leading-4\">\n                  {user?.username || user?.emailAddresses[0]?.emailAddress}\n                </Text>\n              ) : null}\n            </View>\n          </View>\n          <View className=\"flex-row flex-wrap gap-3 py-0.5\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onPress={() => {\n                // TODO: Navigate to account settings screen\n              }}>\n              <Icon as={SettingsIcon} className=\"size-4\" />\n              <Text>Manage Account</Text>\n            </Button>\n            <Button variant=\"outline\" size=\"sm\" className=\"flex-1\" onPress={onSignOut}>\n              <Icon as={LogOutIcon} className=\"size-4\" />\n              <Text>Sign Out</Text>\n            </Button>\n          </View>\n        </View>\n        <Button\n          variant=\"ghost\"\n          size=\"lg\"\n          className=\"h-16 justify-start gap-3 rounded-none rounded-b-md px-3 sm:h-14\"\n          onPress={() => {\n            // TODO: Navigate to add account screen\n          }}>\n          <View className=\"size-10 items-center justify-center\">\n            <View className=\"border-border bg-muted/50 size-7 items-center justify-center rounded-full border border-dashed\">\n              <Icon as={PlusIcon} className=\"size-5\" />\n            </View>\n          </View>\n          <Text>Add account</Text>\n        </Button>\n      </PopoverContent>\n    </Popover>\n  );\n}\n\nfunction UserAvatar(props: Omit<React.ComponentProps<typeof Avatar>, 'alt'>) {\n  const { user } = useUser();\n\n  const { initials, imageSource, userName } = React.useMemo(() => {\n    const userName = user?.fullName || user?.emailAddresses[0]?.emailAddress || 'Unknown';\n    const initials = userName\n      .split(' ')\n      .map((name) => name[0])\n      .join('');\n\n    const imageSource = user?.imageUrl ? { uri: user.imageUrl } : undefined;\n    return { initials, imageSource, userName };\n  }, [user?.imageUrl, user?.fullName, user?.emailAddresses[0]?.emailAddress]);\n\n  return (\n    <Avatar alt={`${userName}'s avatar`} {...props}>\n      <AvatarImage source={imageSource} />\n      <AvatarFallback>\n        <Text>{initials}</Text>\n      </AvatarFallback>\n    </Avatar>\n  );\n}\n",
      "type": "registry:component"
    }
  ]
}